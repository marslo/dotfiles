#!/usr/bin/env bash
# shellcheck source=/dev/null
#=============================================================================
#     FileName : .completion
#       Author : marslo
#      Created : 2025-11-14 20:34:08
#   LastChange : 2026-02-12 16:59:42
#=============================================================================

# /--------------------------------------------------------------
#                            _      _   _
#                           | |    | | (_)
#   ___ ___  _ __ ___  _ __ | | ___| |_ _  ___  _ __
#  / __/ _ \| '_ ` _ \| '_ \| |/ _ \ __| |/ _ \| '_ \
# | (_| (_) | | | | | | |_) | |  __/ |_| | (_) | | | |
#  \___\___/|_| |_| |_| .__/|_|\___|\__|_|\___/|_| |_|
#                     | |
#                     |_|
#
# --------------------------------------------------------------/
declare RT_COMPLETION="$HOME/.jfrog/jfrog_bash_completion"
declare COMPLETION_DIR="${HOME}"/.marslo/bash_completion.d
declare ANSIBLE_COMPLETION_PATH="${COMPLETION_DIR}/ansible-completion"            # https://github.com/dysosmus/ansible-completion
# declare NPM_COMPLETION="$HOME/.npm/lib/node_modules/npm-completion"             # for npm-completion https://github.com/Jephuff/npm-bash-completion

test -f "${RT_COMPLETION}"                          && source "${RT_COMPLETION}"
test -f "${COMPLETION_DIR}"/cht.sh/cht.sh           && source "${COMPLETION_DIR}"/cht.sh/cht.sh
test -f "${COMPLETION_DIR}"/complete_alias          && source "${COMPLETION_DIR}"/complete_alias
test -f "${COMPLETION_DIR}"/npm-groovy-lint.sh      && source "${COMPLETION_DIR}"/npm-groovy-lint.sh
# for git alias completion - should load after source git-completion.sh ( after .imac/.ilinux )
test -f "${COMPLETION_DIR}"/gitalias.sh             && source "${COMPLETION_DIR}"/gitalias.sh

type -P commitlint >/dev/null                       && source "${COMPLETION_DIR}/commitlint.sh"
type -P pre-commit >/dev/null                       && source "${COMPLETION_DIR}/pre-commit.sh"
type -P kubectl    >/dev/null                       && source "${COMPLETION_DIR}/kubectl.sh"
type -P npm        >/dev/null                       && source "${COMPLETION_DIR}/npm.sh"
type -P gh         >/dev/null                       && source "${COMPLETION_DIR}/gh.bash.sh"
type -P bat        >/dev/null                       && source "${COMPLETION_DIR}/bat.sh"
type -P pipx       >/dev/null                       && source "${COMPLETION_DIR}/pipx.sh"
type -P pip        >/dev/null                       && source "${COMPLETION_DIR}/pip.sh"
type -P poetry     >/dev/null                       && source "${COMPLETION_DIR}/poetry.sh"
type -P code       >/dev/null                       && source "${COMPLETION_DIR}/code"
type -P fossa      >/dev/null                       && source "${COMPLETION_DIR}/fossa"
# test -d "${NPM_COMPLETION}"                       && source "${NPM_COMPLETION}/npm-completion.sh"
# via `vault -autocomplete-install`
type -P vault      >/dev/null                       && complete -C "$(type -P vault)" vault
type -t _fd        >/dev/null 2>&1                  && complete -F _fd -o nosort -o bashdefault -o default ff ffs
type -t _comp_cmd_chromium_browser >/dev/null 2>&1  && complete -F _comp_cmd_chromium_browser -o nosort -o bashdefault -o default chrome
complete -o default -o bashdefault chrome

# instead of eval "$(/bin/cat "${ANSIBLE_COMPLETION_PATH}"/*.bash)" -- for fcf
if compgen -G "${ANSIBLE_COMPLETION_PATH}/*.bash" >/dev/null; then
  shopt -s nullglob
  for script in "${ANSIBLE_COMPLETION_PATH}"/*.bash; do
    [[ -f "${script}" ]] && source "${script}"
  done
  shopt -u nullglob
fi

# fzf
if test -f "$HOME"/.fzf.bash; then
  source "$HOME"/.fzf.bash
else
  type -P fzf >/dev/null                            && eval "$(command fzf --bash)"
  test -f "${FZF_HOME}/shell/key-bindings.bash"     && source "${FZF_HOME}/shell/key-bindings.bash"
fi
type -t _fzf_opts_completion >/dev/null 2>&1        && complete -F _fzf_opts_completion -o bashdefault -o default vim vimdiff penv imgview fman

# vim:tabstop=2:softtabstop=2:shiftwidth=2:expandtab:filetype=sh:
